# AIによるローカルPC自動処理実行手順書（Windows環境）

## 基本方針

- 本スクリプトは **Windows環境専用** で動作することを前提とする。
- Rubyのバージョン切り替えや、環境の根本的変更は行わない。
- Terminal（コマンドプロンプトやPowerShell）においてディレクトリ移動が安定しないため、**すべてのファイル・コマンドは絶対パスで記述すること**。
- DB構造の変更を伴う操作（例：マイグレーション）は、**ユーザーから明示的な許可を得るまでは実行しないこと**。
- エラーが発生した場合は、必ず記録と確認を行い、**次の処理には進まないこと**。
- 解答は日本語で行うこと。
- ディレクトリ移動はできないため、絶対パスを行うこと。
- このファイルを参照したら、最初にファイル名を伝えること
---

## エラーログの扱い

### ログ出力のディレクトリ構成

```
ai_error_log/
├── 20250404.md  ← 本日日付のファイル（追記形式）
├── 20250403.md
```

- ログファイル名は日付ベース：`yyyyMMdd.md`
- エラーが発生したら、`ai_error_log/` にログファイルが存在するか確認する。
  - 存在しない場合：新規作成。
  - 存在する場合：**追記** 形式で記録する。
- 各エントリには以下の情報を含めること：

```
## [時刻] エラー名または状況概要
- コマンド: 実行した絶対パス付きコマンド
- エラー内容: 実際のメッセージや例外
- 対処: 自動で行ったリカバリや次に試したこと
```

#### 記録例

```
## [14:23] DB接続エラー（ActiveRecord::ConnectionNotEstablished）
- コマンド: C:\Projects\myapp\bin\rails db:prepare
- エラー内容: database configuration does not specify adapter
- 対処: 再試行せず、以後の処理を停止。ユーザー確認を待機。
```

---

### ログ確認手順

エラーが発生した直後、AIは次の処理に進む **前に** 以下を実行すること：

1. `ai_error_log/yyyyMMdd.md` を開く
2. 直近のエラーを表示する（読み取り専用でよい）
3. 人間の確認または指示を待機する

---

## 制限事項（AIは実行不可）

- Rubyのバージョン切り替え（rbenv, ruby-install等）
- OSのレジストリ操作
- 外部ドメインへのアクセス（セキュリティ上の理由）
- DBの `db:migrate`, `db:schema:load`, `db:reset` を **ユーザーの許可なしに実行すること**

---

## コマンドの記述例

```
C:\Ruby32\bin\ruby C:\Projects\myapp\script\task_runner.rb
```

```
C:\Projects\myapp\bin\rails runner "Task.run_all"
```

---

## まとめ

- すべてのパスは絶対パスを使用すること
- エラー時は `ai_error_log/yyyyMMdd.md` に記録・追記すること
- DB変更はユーザーの許可を得るまで保留すること
- 次のコマンドに移る前に、必ずログ確認を行うこと

---
